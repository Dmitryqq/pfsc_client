(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2bfc9a10"],{"014b":function(e,t,n){"use strict";var i=n("e53d"),r=n("07e3"),s=n("8e60"),o=n("63b6"),a=n("9138"),c=n("ebfd").KEY,l=n("294c"),u=n("dbdb"),f=n("45f2"),d=n("62a0"),m=n("5168"),h=n("ccb9"),p=n("6718"),b=n("47ee"),v=n("9003"),y=n("e4ae"),g=n("f772"),w=n("241e"),F=n("36c3"),O=n("1bc3"),k=n("aebd"),x=n("a159"),C=n("0395"),_=n("bf0b"),S=n("9aa9"),j=n("d9f6"),P=n("c3a1"),N=_.f,T=j.f,D=C.f,E=i.Symbol,I=i.JSON,L=I&&I.stringify,$="prototype",A=m("_hidden"),R=m("toPrimitive"),J={}.propertyIsEnumerable,M=u("symbol-registry"),q=u("symbols"),K=u("op-symbols"),W=Object[$],Y="function"==typeof E&&!!S.f,z=i.QObject,G=!z||!z[$]||!z[$].findChild,Q=s&&l(function(){return 7!=x(T({},"a",{get:function(){return T(this,"a",{value:7}).a}})).a})?function(e,t,n){var i=N(W,t);i&&delete W[t],T(e,t,n),i&&e!==W&&T(W,t,i)}:T,U=function(e){var t=q[e]=x(E[$]);return t._k=e,t},B=Y&&"symbol"==typeof E.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof E},H=function(e,t,n){return e===W&&H(K,t,n),y(e),t=O(t,!0),y(n),r(q,t)?(n.enumerable?(r(e,A)&&e[A][t]&&(e[A][t]=!1),n=x(n,{enumerable:k(0,!1)})):(r(e,A)||T(e,A,k(1,{})),e[A][t]=!0),Q(e,t,n)):T(e,t,n)},V=function(e,t){y(e);var n,i=b(t=F(t)),r=0,s=i.length;while(s>r)H(e,n=i[r++],t[n]);return e},X=function(e,t){return void 0===t?x(e):V(x(e),t)},Z=function(e){var t=J.call(this,e=O(e,!0));return!(this===W&&r(q,e)&&!r(K,e))&&(!(t||!r(this,e)||!r(q,e)||r(this,A)&&this[A][e])||t)},ee=function(e,t){if(e=F(e),t=O(t,!0),e!==W||!r(q,t)||r(K,t)){var n=N(e,t);return!n||!r(q,t)||r(e,A)&&e[A][t]||(n.enumerable=!0),n}},te=function(e){var t,n=D(F(e)),i=[],s=0;while(n.length>s)r(q,t=n[s++])||t==A||t==c||i.push(t);return i},ne=function(e){var t,n=e===W,i=D(n?K:F(e)),s=[],o=0;while(i.length>o)!r(q,t=i[o++])||n&&!r(W,t)||s.push(q[t]);return s};Y||(E=function(){if(this instanceof E)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),t=function(n){this===W&&t.call(K,n),r(this,A)&&r(this[A],e)&&(this[A][e]=!1),Q(this,e,k(1,n))};return s&&G&&Q(W,e,{configurable:!0,set:t}),U(e)},a(E[$],"toString",function(){return this._k}),_.f=ee,j.f=H,n("6abf").f=C.f=te,n("355d").f=Z,S.f=ne,s&&!n("b8e3")&&a(W,"propertyIsEnumerable",Z,!0),h.f=function(e){return U(m(e))}),o(o.G+o.W+o.F*!Y,{Symbol:E});for(var ie="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),re=0;ie.length>re;)m(ie[re++]);for(var se=P(m.store),oe=0;se.length>oe;)p(se[oe++]);o(o.S+o.F*!Y,"Symbol",{for:function(e){return r(M,e+="")?M[e]:M[e]=E(e)},keyFor:function(e){if(!B(e))throw TypeError(e+" is not a symbol!");for(var t in M)if(M[t]===e)return t},useSetter:function(){G=!0},useSimple:function(){G=!1}}),o(o.S+o.F*!Y,"Object",{create:X,defineProperty:H,defineProperties:V,getOwnPropertyDescriptor:ee,getOwnPropertyNames:te,getOwnPropertySymbols:ne});var ae=l(function(){S.f(1)});o(o.S+o.F*ae,"Object",{getOwnPropertySymbols:function(e){return S.f(w(e))}}),I&&o(o.S+o.F*(!Y||l(function(){var e=E();return"[null]"!=L([e])||"{}"!=L({a:e})||"{}"!=L(Object(e))})),"JSON",{stringify:function(e){var t,n,i=[e],r=1;while(arguments.length>r)i.push(arguments[r++]);if(n=t=i[1],(g(t)||void 0!==e)&&!B(e))return v(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!B(t))return t}),i[1]=t,L.apply(I,i)}}),E[$][R]||n("35e8")(E[$],R,E[$].valueOf),f(E,"Symbol"),f(Math,"Math",!0),f(i.JSON,"JSON",!0)},"0395":function(e,t,n){var i=n("36c3"),r=n("6abf").f,s={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(e){try{return r(e)}catch(t){return o.slice()}};e.exports.f=function(e){return o&&"[object Window]"==s.call(e)?a(e):r(i(e))}},"268f":function(e,t,n){e.exports=n("fde4")},"32a6":function(e,t,n){var i=n("241e"),r=n("c3a1");n("ce7e")("keys",function(){return function(e){return r(i(e))}})},"355d":function(e,t){t.f={}.propertyIsEnumerable},"454f":function(e,t,n){n("46a7");var i=n("584a").Object;e.exports=function(e,t,n){return i.defineProperty(e,t,n)}},"46a7":function(e,t,n){var i=n("63b6");i(i.S+i.F*!n("8e60"),"Object",{defineProperty:n("d9f6").f})},"47ee":function(e,t,n){var i=n("c3a1"),r=n("9aa9"),s=n("355d");e.exports=function(e){var t=i(e),n=r.f;if(n){var o,a=n(e),c=s.f,l=0;while(a.length>l)c.call(e,o=a[l++])&&t.push(o)}return t}},"4cb2":function(e,t,n){},6718:function(e,t,n){var i=n("e53d"),r=n("584a"),s=n("b8e3"),o=n("ccb9"),a=n("d9f6").f;e.exports=function(e){var t=r.Symbol||(r.Symbol=s?{}:i.Symbol||{});"_"==e.charAt(0)||e in t||a(t,e,{value:o.f(e)})}},"6abf":function(e,t,n){var i=n("e6f3"),r=n("1691").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,r)}},7514:function(e,t,n){"use strict";var i=n("5ca1"),r=n("0a49")(5),s="find",o=!0;s in[]&&Array(1)[s](function(){o=!1}),i(i.P+i.F*o,"Array",{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(s)},"85f2":function(e,t,n){e.exports=n("454f")},"883a":function(e,t,n){"use strict";var i=n("4cb2"),r=n.n(i);r.a},"8aae":function(e,t,n){n("32a6"),e.exports=n("584a").Object.keys},"9aa9":function(e,t){t.f=Object.getOwnPropertySymbols},a4bb:function(e,t,n){e.exports=n("8aae")},bf0b:function(e,t,n){var i=n("355d"),r=n("aebd"),s=n("36c3"),o=n("1bc3"),a=n("07e3"),c=n("794b"),l=Object.getOwnPropertyDescriptor;t.f=n("8e60")?l:function(e,t){if(e=s(e),t=o(t,!0),c)try{return l(e,t)}catch(n){}if(a(e,t))return r(!i.f.call(e,t),e[t])}},bf90:function(e,t,n){var i=n("36c3"),r=n("bf0b").f;n("ce7e")("getOwnPropertyDescriptor",function(){return function(e,t){return r(i(e),t)}})},c467:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"commitAdd view"},[n("Navbar"),e.isLoading?n("Loader"):n("div",{staticClass:"col-md-7 mx-auto my-5"},[e._l(e.errors,function(t){return n("div",{key:t,staticClass:"alert alert-danger",attrs:{role:"alert"}},[e._v("\n            "+e._s(t)+"\n        ")])}),e.success?n("div",{staticClass:"alert alert-success"},[e._v("\n            "+e._s(e.success)+"\n        ")]):e._e(),n("table",{staticClass:"table table-sm table-borderless"},[n("tr",[n("th",[e._v("Метка "),n("span",{staticClass:"text-danger"},[e._v("*")])]),n("td",[n("select",{directives:[{name:"model",rawName:"v-model",value:e.commit.markId,expression:"commit.markId"}],staticClass:"form-control form-control-sm col-lg-6",attrs:{disabled:e.errors.length>0&&0==e.toDeleteCommit},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.commit,"markId",t.target.multiple?n:n[0])}}},e._l(e.marks,function(t){return n("option",{key:t.id,domProps:{value:t.id}},[e._v(e._s(t.name))])}),0)])]),n("tr",[n("th",[e._v("Описание "),n("span",{staticClass:"text-danger"},[e._v("*")])]),n("td",[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.commit.description,expression:"commit.description"}],staticClass:"form-control",attrs:{cols:"",rows:"7",disabled:e.errors.length>0&&0==e.toDeleteCommit},domProps:{value:e.commit.description},on:{input:function(t){t.target.composing||e.$set(e.commit,"description",t.target.value)}}})])])]),e._l(e.fileTypes,function(t,i){return n("div",{key:t.id,staticClass:"card my-2"},[n("div",{staticClass:"card-header"},[e._v("\n                "+e._s(t.name)+"\n                "),t.required?n("span",{staticClass:"text-danger"},[e._v("*")]):e._e(),e.selectedFiles[t.id]&&!(e.selectedFiles[t.id].length<t.maxAmount)||e.validFiles[t.id]?e._e():n("label",{staticClass:"icon-btn ml-3"},[n("input",{attrs:{type:"file",multiple:""},on:{change:function(t){return e.onFileChanged(t,i)}}}),n("i",{staticClass:"fas fa-plus"})]),n("Popover",[e._v("\n                    maximum: "+e._s(t.maxAmount)+" file(s) "),n("br"),e._v("\n                    extensions: "+e._s(t.types)+"\n                ")])],1),e.showFileNames&&e.selectedFiles[t.id]&&e.selectedFiles[t.id].length?n("div",{staticClass:"card-body"},[n("table",{staticClass:"table table-sm table-borderless",staticStyle:{"margin-bottom":"0"}},e._l(e.selectedFiles[t.id],function(i,r){return n("tr",{key:i.name},[n("td",[e._v(e._s(r+1))]),n("td",[e._v(e._s(i.name))]),n("td",[e.validFiles[t.id]?n("label",{staticClass:"icon-btn text-secondary"},[e._v("\n                                загружено\n                            ")]):n("label",{staticClass:"icon-btn",on:{click:function(n){return e.deleteFile(t.id,r)}}},[n("i",{staticClass:"fas fa-trash"})])])])}),0)]):e._e()])}),n("div",{staticClass:"text-center"},[n("button",{staticClass:"btn btn-primary my-3",on:{click:e.send}},[e._v("\n                Отправить\n            ")])])],2)],1)},r=[],s=(n("96cf"),n("7f7f"),n("7514"),n("268f")),o=n.n(s),a=n("e265"),c=n.n(a),l=n("a4bb"),u=n.n(l),f=n("85f2"),d=n.n(f);function m(e,t,n){return t in e?d()(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=u()(n);"function"===typeof c.a&&(i=i.concat(c()(n).filter(function(e){return o()(n,e).enumerable}))),i.forEach(function(t){m(e,t,n[t])})}return e}var p=n("3b8d"),b=n("d178"),v=n("555f"),y=n("cc8d"),g=n("2f62"),w=n("4be7"),F=n("5118"),O=function(e){return new w["Promise"](function(t){return Object(F["setTimeout"])(t,e)})};function k(e,t){return x.apply(this,arguments)}function x(){return x=Object(p["a"])(regeneratorRuntime.mark(function e(t,n){var i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:i=0;case 1:if(!(i<t.length)){e.next=7;break}return e.next=4,n(t[i],i,t);case 4:i++,e.next=1;break;case 7:case"end":return e.stop()}},e)})),x.apply(this,arguments)}var C={name:"Commit",components:{Navbar:b["a"],Loader:v["a"],Popover:y["a"]},computed:h({marks:function(){return this.$store.state.marks.marks}},Object(g["b"])("typeOfFiles",{fileTypes:"getUserFileTypes"})),methods:{getMarks:function(){var e=this;this.isLoading=!0,this.$store.dispatch("marks/getMarks").then(function(){e.commit.markId=e.marks[0].id}).finally(function(){e.isLoading=!1})},getFileTypes:function(){var e=this;this.isLoading=!0,this.$store.dispatch("typeOfFiles/getTypeOfFiles").finally(function(){e.isLoading=!1})},onFileChanged:function(e,t){this.errors=[],this.success="",this.showFileNames=!1;var n=this.fileTypes[t].id;this.selectedFiles[n]||(this.selectedFiles[n]=[]);for(var i=0;i<e.target.files.length;i++){if(this.selectedFiles[n].length>=this.fileTypes[t].maxAmount)break;this.selectedFiles[n].find(function(t){return t.name==e.target.files[i].name})?this.errors.push(e.target.files[i].name+" уже добавлен"):this.selectedFiles[n].push(e.target.files[i])}this.showFileNames=!0},deleteFile:function(e,t){this.showFileNames=!1,this.selectedFiles[e].splice(t,1),this.showFileNames=!0},validate:function(){if(""==this.commit.description||null==this.commit.markId)return!1;for(var e=!0,t=0;t<this.fileTypes.length;t++)if(this.fileTypes[t].required&&(null==this.selectedFiles[this.fileTypes[t].id]||this.selectedFiles[this.fileTypes[t].id].length<1)){e=!1;break}return e},sendCommit:function(){var e=this;return new w["Promise"](function(t,n){null!=e.commit.id?t(e.commit.id):e.$store.dispatch("commits/addCommit",e.commit).then(function(n){e.commit.id=n,t(n)}).catch(function(e){n(e)})})},sendFile:function(e,t){var n=this;return new w["Promise"](function(i,r){var s=new FormData;s.append("commitId",e),s.append("fileTypeId",t),n.selectedFiles[t].map(function(e){s.append("file",e)}),n.$store.dispatch("commits/addFiles",s).then(function(){i()}).catch(function(e){r(e)})})},send:function(){var e=Object(p["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.isLoading=!0,this.toDeleteCommit=null,this.errors=[],this.success="",this.validate()){e.next=8;break}return this.isLoading=!1,this.errors.push("Заполните все обязательные поля!"),e.abrupt("return");case 8:this.showFileNames=!1,this.sendCommit().then(function(){var e=Object(p["a"])(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,k(t.fileTypes,function(){var e=Object(p["a"])(regeneratorRuntime.mark(function e(i){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.selectedFiles[i.id]&&t.selectedFiles[i.id].length>0&&!t.validFiles[i.id]&&!t.toDeleteCommit&&t.sendFile(n,i.id).then(function(){t.validFiles[i.id]=!0}).catch(function(e){t.showFileNames=!1,t.validFiles[i.id]=!1,t.errors.push(e.message),i.required&&(t.toDeleteCommit=!0)}),e.next=3,O(500);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:t.isLoading=!1,t.toDeleteCommit?(t.deleteCommit(),t.validFiles={},t.commit.id=null):t.errors.length<1?(t.clearData(),t.showSuccess("Накат успешно добавлен")):t.toDeleteCommit=!1,t.showFileNames=!0;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){t.errors.push(e.message)}).finally(function(){t.isLoading=!1});case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),deleteCommit:function(){this.$store.dispatch("commits/deleteCommit",this.commit.id)},clearData:function(){this.commit={id:null,description:"",markId:this.marks[0].id},this.showFileNames=null,this.selectedFiles={},this.errors=[],this.success="",this.validFiles={}},showSuccess:function(e){var t=this;this.success=e,Object(F["setTimeout"])(function(){t.success=null},3e3)}},data:function(){return{commit:{id:null,description:"",markId:null},selectedFiles:{},showFileNames:null,errors:[],success:"",validFiles:{},toDeleteCommit:null,isLoading:!1}},mounted:function(){this.getMarks(),this.getFileTypes()}},_=C,S=(n("883a"),n("2877")),j=Object(S["a"])(_,i,r,!1,null,null,null);t["default"]=j.exports},ccb9:function(e,t,n){t.f=n("5168")},ce7e:function(e,t,n){var i=n("63b6"),r=n("584a"),s=n("294c");e.exports=function(e,t){var n=(r.Object||{})[e]||Object[e],o={};o[e]=t(n),i(i.S+i.F*s(function(){n(1)}),"Object",o)}},e265:function(e,t,n){e.exports=n("ed33")},ebfd:function(e,t,n){var i=n("62a0")("meta"),r=n("f772"),s=n("07e3"),o=n("d9f6").f,a=0,c=Object.isExtensible||function(){return!0},l=!n("294c")(function(){return c(Object.preventExtensions({}))}),u=function(e){o(e,i,{value:{i:"O"+ ++a,w:{}}})},f=function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!s(e,i)){if(!c(e))return"F";if(!t)return"E";u(e)}return e[i].i},d=function(e,t){if(!s(e,i)){if(!c(e))return!0;if(!t)return!1;u(e)}return e[i].w},m=function(e){return l&&h.NEED&&c(e)&&!s(e,i)&&u(e),e},h=e.exports={KEY:i,NEED:!1,fastKey:f,getWeak:d,onFreeze:m}},ed33:function(e,t,n){n("014b"),e.exports=n("584a").Object.getOwnPropertySymbols},fde4:function(e,t,n){n("bf90");var i=n("584a").Object;e.exports=function(e,t){return i.getOwnPropertyDescriptor(e,t)}}}]);
//# sourceMappingURL=chunk-2bfc9a10.06c1c4c5.js.map