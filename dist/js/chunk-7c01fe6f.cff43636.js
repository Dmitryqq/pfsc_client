(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c01fe6f"],{"2d0a":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"users view"},[e.isLoading?s("Loader"):s("div",[e.error?s("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[e._v("\n            "+e._s(e.error)+"\n        ")]):e._e(),e.success?s("div",{staticClass:"alert alert-success"},[e._v("\n            "+e._s(e.success)+"\n        ")]):e._e(),s("table",{staticClass:"table table-sm table-responsive"},[s("thead",[s("tr",[s("th",[e._v("№")]),s("th",[e._v("Логин")]),s("th",[e._v("Пароль")]),s("th",[e._v("Имя")]),s("th",[e._v("Email")]),s("th",[e._v("Активен")]),s("th",[e._v("Роль")]),s("th"),s("th"),s("th")])]),e._l(e.users,function(t){return s("tr",{key:t.id},[s("td",[e._v(e._s(t.id))]),e.editMode&&t.id==e.selectedUser.id?s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"user.username"}],staticClass:"form-control form-control-sm",attrs:{type:"text",name:"username"},domProps:{value:t.username},on:{input:function(s){s.target.composing||e.$set(t,"username",s.target.value)}}})]):s("td",[e._v(e._s(t.username))]),e.editMode&&t.id==e.selectedUser.id?s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"user.password"}],staticClass:"form-control form-control-sm",attrs:{type:"password"},domProps:{value:t.password},on:{input:function(s){s.target.composing||e.$set(t,"password",s.target.value)}}})]):s("td",[e._v("***")]),e.editMode&&t.id==e.selectedUser.id?s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"user.name"}],staticClass:"form-control form-control-sm",attrs:{type:"text"},domProps:{value:t.name},on:{input:function(s){s.target.composing||e.$set(t,"name",s.target.value)}}})]):s("td",[e._v(e._s(t.name))]),e.editMode&&t.id==e.selectedUser.id?s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"user.email"}],staticClass:"form-control form-control-sm",attrs:{type:"text"},domProps:{value:t.email},on:{input:function(s){s.target.composing||e.$set(t,"email",s.target.value)}}})]):s("td",[e._v(e._s(t.email))]),e.editMode&&t.id==e.selectedUser.id?s("td",[s("div",{staticClass:"form-check text-center"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.enabled,expression:"user.enabled"}],staticClass:"form-check-input position-static",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.enabled)?e._i(t.enabled,null)>-1:t.enabled},on:{change:function(s){var r=t.enabled,a=s.target,n=!!a.checked;if(Array.isArray(r)){var o=null,i=e._i(r,o);a.checked?i<0&&e.$set(t,"enabled",r.concat([o])):i>-1&&e.$set(t,"enabled",r.slice(0,i).concat(r.slice(i+1)))}else e.$set(t,"enabled",n)}}})])]):s("td",[e._v(e._s(t.enabled))]),e.editMode&&t.id==e.selectedUser.id?s("td",[s("div",{staticClass:"form-group"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.roleId,expression:"user.roleId"}],staticClass:"form-control form-control-sm",on:{change:function(s){var r=Array.prototype.filter.call(s.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(t,"roleId",s.target.multiple?r:r[0])}}},[s("option",{attrs:{disabled:"",value:""}},[e._v("Роль")]),e._l(e.roles,function(t){return s("option",{key:t.id,domProps:{value:t.id}},[e._v("\n                            "+e._s(t.roleName)+"\n                        ")])})],2)])]):s("td",[e._v(e._s(t.role.roleName))]),e.editMode&&t.id==e.selectedUser.id?s("td",[s("span",{staticClass:"icon-btn"},[s("i",{staticClass:"fas fa-save",staticStyle:{"margin-left":"2px"},on:{click:function(s){return e.updateUser(t)}}}),s("i",{staticClass:"fas fa-times",staticStyle:{"margin-left":"23px"},on:{click:e.disableEditMode}})])]):s("td",[s("span",{staticClass:"icon-btn"},[s("i",{staticClass:"fas fa-edit",on:{click:function(s){return e.enableEditMode(t)}}}),s("i",{staticClass:"fas fa-trash",staticStyle:{"margin-left":"20px"},on:{click:function(s){return e.deleteUser(t)}}})])])])}),s("tr",[s("td"),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.username,expression:"user.username"}],staticClass:"form-control form-control-sm",attrs:{type:"text",name:"username"},domProps:{value:e.user.username},on:{input:function(t){t.target.composing||e.$set(e.user,"username",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"}],staticClass:"form-control form-control-sm",attrs:{type:"password"},domProps:{value:e.user.password},on:{input:function(t){t.target.composing||e.$set(e.user,"password",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.name,expression:"user.name"}],staticClass:"form-control form-control-sm",attrs:{type:"text",name:"Name"},domProps:{value:e.user.name},on:{input:function(t){t.target.composing||e.$set(e.user,"name",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.email,expression:"user.email"}],staticClass:"form-control form-control-sm",attrs:{type:"text",name:"Email"},domProps:{value:e.user.email},on:{input:function(t){t.target.composing||e.$set(e.user,"email",t.target.value)}}})]),s("td",[s("div",{staticClass:"form-check text-center"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.enabled,expression:"user.enabled"}],staticClass:"form-check-input position-static",attrs:{type:"checkbox",name:"Enabled"},domProps:{checked:Array.isArray(e.user.enabled)?e._i(e.user.enabled,null)>-1:e.user.enabled},on:{change:function(t){var s=e.user.enabled,r=t.target,a=!!r.checked;if(Array.isArray(s)){var n=null,o=e._i(s,n);r.checked?o<0&&e.$set(e.user,"enabled",s.concat([n])):o>-1&&e.$set(e.user,"enabled",s.slice(0,o).concat(s.slice(o+1)))}else e.$set(e.user,"enabled",a)}}})])]),s("td",[s("div",{staticClass:"form-group"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.user.roleId,expression:"user.roleId"}],staticClass:"form-control form-control-sm",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.user,"roleId",t.target.multiple?s:s[0])}}},[s("option",{attrs:{disabled:"",value:""}},[e._v("Роль")]),e._l(e.roles,function(t){return s("option",{key:t.id,domProps:{value:t.id}},[e._v("\n                            "+e._s(t.roleName)+"\n                        ")])})],2)])]),s("td",[s("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"submit"},on:{click:e.addUser}},[e._v("Добавить")])])])],2),s("p",{staticClass:"text-center"},[e._v("Если изменение пароля не требуется, то при изменении оставьте поле пустым")])])],1)},a=[],n=(s("7f7f"),s("6762"),s("2fdb"),s("555f")),o={components:{Loader:n["a"]},data:function(){return{user:{username:"",password:"",name:"",email:"",enabled:"",roleId:""},isLoading:!1,success:null,error:null,editMode:!1,selectedUser:{}}},computed:{users:function(){return this.$store.state.users.users},roles:function(){return this.$store.state.roles.roles},configs:function(){return this.$store.state.configs.configs}},created:function(){this.getUsers(),this.getRoles(),this.getConfigs()},methods:{getUsers:function(){var e=this;this.isLoading=!0,this.$store.dispatch("users/getUsers").catch(function(t){e.error=t.message}).finally(function(){e.isLoading=!1})},getRoles:function(){var e=this;this.isLoading=!0,this.$store.dispatch("roles/getRoles").catch(function(t){e.error=t.message}).finally(function(){e.isLoading=!1})},getConfigs:function(){var e=this;this.$store.dispatch("configs/getConfigs").then(function(){e.setDefaultPassword()}).catch(function(t){e.error=t.message}).finally(function(){e.isLoading=!1})},setDefaultPassword:function(){var e=this.$store.state.configs.configs.filter(function(e){return e.name.includes("defaultPassword")});e[0]&&(this.user.password=e[0].value)},addUser:function(){var e=this;this.error=null,this.user.username.length>0&&this.user.password.length>0&&this.user.name.length>0&&this.user.email.length>0&&0!=this.user.roleId&&this.$store.dispatch("users/addUser",this.user).then(function(){e.showSuccess("Пользователь успешно добавлен"),e.clearForm()}).catch(function(t){e.error=t.message})},deleteUser:function(e){var t=this;confirm("Подтвердите удаление пользователя '"+e.username+"'")&&this.$store.dispatch("users/deleteUser",e.id).then(function(){t.error=null,t.showSuccess("Пользователь успешно удален")}).catch(function(e){t.error=e.message})},updateUser:function(e){var t=this;confirm("Подтвердите обновление пользователя '"+e.username+"'")&&this.$store.dispatch("users/updateUser",e).then(function(){t.showSuccess("Пользователь успешно обновлен")}).catch(function(e){t.error=e.message}),this.editMode=!1},clearForm:function(){this.user.username="",this.user.password="",this.user.name="",this.user.email="",this.user.roleId=null,this.user.enabled=!1},enableEditMode:function(e){this.editMode=!0,e.password="",this.selectedUser.id=e.id},disableEditMode:function(){this.editMode=!1},showSuccess:function(e){var t=this;this.success=e,setTimeout(function(){t.success=null},3e3)}}},i=o,l=(s("b171"),s("2877")),c=Object(l["a"])(i,r,a,!1,null,"74395ca3",null);t["default"]=c.exports},b171:function(e,t,s){"use strict";var r=s("cfb1"),a=s.n(r);a.a},cfb1:function(e,t,s){}}]);
//# sourceMappingURL=chunk-7c01fe6f.cff43636.js.map